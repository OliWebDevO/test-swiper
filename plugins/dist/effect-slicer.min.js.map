{"version":3,"file":"effect-slicer.min.js","names":["window","SwiperElementRegisterParams","swiper","extendParams","on","emit","slicerEffect","split","loopIsFixing","createImages","slides","forEach","slideEl","querySelector","imageEl","nextEl","nextElementSibling","cloneContainerEl","document","createElement","classList","add","i","params","div","appendChild","cloneNode","parentNode","insertBefore","setImages","querySelectorAll","style","width","height","cloneEl","cloneElIndex","cloneImg","direction","top","left","setTransition","duration","images","contentEl","transitionDuration","imageIndex","transitionTimingFunction","speed","length","activeIndex","isVirtual","virtual","enabled","eventTriggered","transitionEndTarget","find","parseInt","getAttribute","onTransitionEnd","e","target","removeEventListener","destroyed","animating","evt","CustomEvent","bubbles","cancelable","wrapperEl","dispatchEvent","addEventListener","effectVirtualTransitionEnd","requestAnimationFrame","effect","axis","slideIndex","transform","slideProgress","progress","size","setTranslate","_s","classNames","push","overwriteParams","slidesPerView","slidesPerGroup","watchSlidesProgress","spaceBetween","virtualTranslate","Object","assign","originalParams","translate"],"sources":["../demo-vite/effect-slicer.esm.js"],"sourcesContent":["if (typeof window !== 'undefined' && window.SwiperElementRegisterParams) {\n  window.SwiperElementRegisterParams(['slicerEffect']);\n}\n\nexport default function EffectSlicer({ swiper, extendParams, on, emit }) {\n  extendParams({\n    slicerEffect: {\n      split: 5,\n    },\n  });\n\n  let loopIsFixing = false;\n\n  function effectVirtualTransitionEnd({ duration }) {\n    const { slides, activeIndex } = swiper;\n    const isVirtual = swiper.virtual && swiper.params.virtual.enabled;\n\n    if (duration !== 0) {\n      let eventTriggered = false;\n      const activeSlideEl = isVirtual\n        ? slides.find(\n            (slideEl) =>\n              parseInt(slideEl.getAttribute('data-swiper-slide-index'), 10) ===\n              activeIndex,\n          )\n        : slides[activeIndex];\n      const transitionEndTarget = activeSlideEl.querySelector(\n        '.swiper-slicer-image-clone:nth-child(1)',\n      );\n      if (!transitionEndTarget) return;\n      const onTransitionEnd = (e) => {\n        if (e.target !== transitionEndTarget) return;\n        transitionEndTarget.removeEventListener(\n          'transitionend',\n          onTransitionEnd,\n        );\n        if (eventTriggered) return;\n        if (!swiper || swiper.destroyed) return;\n        eventTriggered = true;\n        swiper.animating = false;\n\n        const evt = new window.CustomEvent('transitionend', {\n          bubbles: true,\n          cancelable: true,\n        });\n        swiper.wrapperEl.dispatchEvent(evt);\n      };\n      transitionEndTarget.addEventListener('transitionend', onTransitionEnd);\n    }\n  }\n\n  const createImages = () => {\n    swiper.slides.forEach((slideEl) => {\n      if (slideEl.querySelector('.swiper-slicer-image-clones')) return;\n      const imageEl = slideEl.querySelector('.swiper-slicer-image');\n      if (!imageEl) return;\n      const nextEl = imageEl.nextElementSibling;\n      const cloneContainerEl = document.createElement('div');\n      cloneContainerEl.classList.add('swiper-slicer-image-clones');\n      for (let i = 0; i < swiper.params.slicerEffect.split; i += 1) {\n        const div = document.createElement('div');\n        div.classList.add('swiper-slicer-image-clone');\n        div.appendChild(imageEl.cloneNode());\n        cloneContainerEl.appendChild(div);\n      }\n      if (nextEl) {\n        imageEl.parentNode.insertBefore(cloneContainerEl, nextEl);\n      } else {\n        imageEl.parentNode.appendChild(cloneContainerEl);\n      }\n    });\n  };\n\n  const setImages = () => {\n    swiper.slides.forEach((slideEl) =>\n      slideEl.querySelectorAll('.swiper-slicer-image').forEach((imageEl) => {\n        imageEl.style.width = `${swiper.width}px`;\n        imageEl.style.height = `${swiper.height}px`;\n      }),\n    );\n    swiper.slides.forEach((slideEl) => {\n      slideEl\n        .querySelectorAll('.swiper-slicer-image-clone')\n        .forEach((cloneEl, cloneElIndex) => {\n          const cloneImg = cloneEl.querySelector('.swiper-slicer-image');\n          if (swiper.params.direction === 'horizontal') {\n            cloneEl.style.height = `${100 / swiper.params.slicerEffect.split}%`;\n            cloneEl.style.top = `${\n              (100 / swiper.params.slicerEffect.split) * cloneElIndex\n            }%`;\n            cloneImg.style.top = `-${100 * cloneElIndex}%`;\n          } else {\n            cloneEl.style.width = `${100 / swiper.params.slicerEffect.split}%`;\n            cloneEl.style.left = `${\n              (100 / swiper.params.slicerEffect.split) * cloneElIndex\n            }%`;\n            cloneImg.style.left = `-${100 * cloneElIndex}%`;\n          }\n        });\n    });\n  };\n\n  const setTranslate = () => {\n    const axis = swiper.params.direction === 'vertical' ? 'Y' : 'X';\n    const isVirtual = swiper.virtual && swiper.params.virtual.enabled;\n    swiper.slides.forEach((slideEl, slideIndex) => {\n      if (isVirtual)\n        slideIndex = parseInt(\n          slideEl.getAttribute('data-swiper-slide-index'),\n          10,\n        );\n      slideEl.style.transform = `translate${axis}(-${slideIndex * 100}%)`;\n      const slideProgress = slideEl.progress;\n      const contentEl = slideEl.querySelector('.swiper-slide-content');\n      if (contentEl) {\n        contentEl.style.transform = `translate${axis}(${\n          swiper.size * -slideProgress * 1.2\n        }px)`;\n      }\n\n      const images = slideEl.querySelectorAll('.swiper-slicer-image-clone');\n      images.forEach((imageEl) => {\n        const progress = -slideProgress;\n        imageEl.style.transform = `translate${axis}(${progress * 100}%)`;\n      });\n    });\n  };\n\n  const setTransition = (duration) => {\n    swiper.slides.forEach((slideEl) => {\n      const images = slideEl.querySelectorAll('.swiper-slicer-image-clone');\n      const contentEl = slideEl.querySelector('.swiper-slide-content');\n      if (contentEl) {\n        contentEl.style.transitionDuration = `${duration}ms`;\n      }\n      images.forEach((imageEl, imageIndex) => {\n        if (duration === 0) {\n          imageEl.style.transitionTimingFunction = 'ease-out';\n          if (loopIsFixing) {\n            imageEl.style.transitionDuration = `0ms`;\n          } else {\n            imageEl.style.transitionDuration = `${\n              swiper.params.speed +\n              (swiper.params.speed / (images.length - 1)) *\n                (images.length - imageIndex - 1)\n            }ms`;\n          }\n        } else {\n          imageEl.style.transitionTimingFunction = '';\n          imageEl.style.transitionDuration = `${\n            duration +\n            (duration / (images.length - 1)) * (images.length - imageIndex - 1)\n          }ms`;\n        }\n      });\n    });\n    effectVirtualTransitionEnd({ duration });\n  };\n\n  on('slideChange', () => {\n    if (\n      swiper.virtual &&\n      swiper.params.virtual &&\n      swiper.params.virtual.enabled\n    ) {\n      requestAnimationFrame(() => {\n        createImages();\n        setImages();\n      });\n    }\n  });\n\n  on('beforeLoopFix', () => {\n    loopIsFixing = true;\n  });\n  on('loopFix', () => {\n    loopIsFixing = false;\n  });\n\n  on('setTranslate', () => {\n    if (swiper.params.effect !== 'slicer') return;\n\n    setTranslate();\n  });\n\n  on('setTransition', (_s, duration) => {\n    if (swiper.params.effect !== 'slicer') return;\n    setTransition(duration);\n  });\n\n  on('slidesLengthChange', () => {\n    createImages();\n    setImages();\n  });\n\n  on('beforeInit', () => {\n    if (swiper.params.effect !== 'slicer') return;\n\n    swiper.classNames.push('swiper-slicer');\n\n    const overwriteParams = {\n      slidesPerView: 1,\n      slidesPerGroup: 1,\n      watchSlidesProgress: true,\n      spaceBetween: 0,\n      virtualTranslate: true,\n    };\n\n    Object.assign(swiper.params, overwriteParams);\n    Object.assign(swiper.originalParams, overwriteParams);\n  });\n  on('init', () => {\n    if (swiper.params.effect !== 'slicer') return;\n    createImages();\n    emit('setTranslate', swiper, swiper.translate);\n  });\n\n  on('resize init', () => {\n    if (swiper.params.effect !== 'slicer') return;\n    setImages();\n  });\n}\n"],"mappings":"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"}